"use strict";var MAX_SUGGESTIONS=50,TOTAL_PAGE_RESULTS=0,SEARCH_QUERY="",COUNT=0,debounce=function(n,r){function e(){var e=this,t=arguments;clearTimeout(i),i=setTimeout(function(){return n.apply(e,t)},r)}var i;return e.cancel=function(){clearTimeout(i),i=null},e},convertObjToUrlParams=function(t){return Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")},createDomNode=function(e,t){var n=document.createElement(e);for(var r in t)n.setAttribute(r,t[r]);return n},get_section_html=function(e,t){var n=e._source.title;void 0!==e.highlight["sections.title"]&&1<=e.highlight["sections.title"].length&&(n=e.highlight["sections.title"][0]);var r=e._source.content.substring(0,100)+" ...";void 0!==e.highlight["sections.content"]&&1<=e.highlight["sections.content"].length&&(r="... "+e.highlight["sections.content"][0]+" ...");var i="".concat(t,"#").concat(e._source.id),o="hit__"+COUNT;return $u.template('<a href="<%= section_link %>">             <div class="outer_div_page_results" id="<%= section_id %>">                 <span class="search__result__subheading">                     <%= section_subheading %>                 </span>                 <p class="search__result__content">                     <%= section_content %>                 </p>             </div>         </a>         <br class="br-for-hits">',{section_link:i,section_id:o,section_subheading:n,section_content:r})},get_domain_html=function(e,t){var n="".concat(t,"#").concat(e._source.anchor),r=e._source.role_name,i=e._source.type_display,o=e._source.doc_display,a=e._source.display_name,s=e._source.name;void 0!==e.highlight&&null!==e.highlight&&(void 0!==e.highlight["domains.name"]&&1<=e.highlight["domains.name"].length&&(s=e.highlight["domains.name"][0]),void 0!==e.highlight["domains.display_name"]&&1<=e.highlight["domains.display_name"].length&&(a=e.highlight["domains.display_name"][0]),void 0!==e.highlight["domains.type_display"]&&1<=e.highlight["domains.type_display"].length&&(i=e.highlight["domains.type_display"][0]));var l="";"string"==typeof i&&0<i.length&&(l+=i+" -- "),"string"==typeof s&&0<s.length&&(l+=s+" "),"string"==typeof o&&0<o.length&&(l+="-- in "+o);var c="";c="string"==typeof a&&2<=a.length?"("+r+") "+a:r;var u="hit__"+COUNT;return $u.template('<a href="<%= domain_link %>">             <div class="outer_div_page_results" id="<%= domain_id %>">                 <span class="search__result__subheading">                     <%= domain_subheading %>                 </span>                 <p class="search__result__content"><%= domain_content %></p>             </div>         </a>         <br class="br-for-hits">',{domain_link:n,domain_id:u,domain_content:l,domain_subheading:c})},generateSingleResult=function(e,t){var n=createDomNode("div"),r="".concat(e.link).concat(DOCUMENTATION_OPTIONS.FILE_SUFFIX),i=r+"?highlight="+encodeURIComponent(SEARCH_QUERY),o=e.title;void 0!==e.highlight&&null!==e.highlight&&void 0!==e.highlight.title&&null!==e.highlight.title&&(o=e.highlight.title),t!==e.project&&(o+=" "+$u.template('<small class="rtd_ui_search_subtitle">                     (from project <%= project %>)                 </small>',{project:e.project})),o+="<br>",n.innerHTML+=$u.template('<a href="<%= page_link %>">             <h2 class="search__result__title">                 <%= page_title %>             </h2>         </a>',{page_link:i,page_title:o});for(var a=0;a<e.inner_hits.length;++a){var s=e.inner_hits[a].type;COUNT+=1;var l="";"sections"===s?l=get_section_html(e.inner_hits[a],r):"domains"===s&&(l=get_domain_html(e.inner_hits[a],r)),n.innerHTML+=l}return n},generateSuggestionsList=function(e,t){for(var n=createDomNode("div",{class:"search__result__box"}),r=0;r<TOTAL_PAGE_RESULTS;++r){var i=createDomNode("div",{class:"search__result__single"}),o=generateSingleResult(e.results[r],t);i.appendChild(o),n.appendChild(i)}return n},removeAllActive=function(){for(var t=document.querySelectorAll(".outer_div_page_results"),e=Object.keys(t).map(function(e){return t[e]}),n=1;n<=e.length;++n)e[n-1].classList.remove("active")},addActive=function(e){var t=document.querySelector("#hit__"+e);null!==t&&(t.classList.add("active"),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))},getInputField=function(){var t;try{if(null==(t=document.querySelector("div[role='search'] input")))throw"'div[role='search'] input' not found"}catch(e){t=document.querySelector("input[name='q']")}return t},removeResults=function(){for(var e=document.querySelectorAll(".search__result__box"),t=0;t<e.length;++t)e[t].parentElement.removeChild(e[t])},getErrorDiv=function(e){var t=createDomNode("div",{class:"search__result__box",style:"color: black; min-width: 300px"});return t.innerHTML=e,t},fetchAndGenerateResults=function(e,i){var o=document.querySelector(".search__outer");removeResults();var t=createDomNode("div",{class:"search__result__box"});t.innerHTML="Searching ....",o.appendChild(t);var n=function(){$.ajax({url:e,crossDomain:!0,xhrFields:{withCredentials:!0},complete:function(e,t){if("success"===t||void 0!==e.responseJSON)if(0<e.responseJSON.results.length){TOTAL_PAGE_RESULTS=MAX_SUGGESTIONS<=e.responseJSON.results.length?MAX_SUGGESTIONS:e.responseJSON.results.length;var n=generateSuggestionsList(e.responseJSON,i);removeResults(),o.appendChild(n),o.addEventListener("mouseenter",function(e){removeAllActive()})}else{removeResults();var r=getErrorDiv("No Results Found");o.appendChild(r)}},error:function(e,t,n){removeResults();var r=getErrorDiv("Error Occurred. Please try again.");o.appendChild(r)}})};return n=debounce(n,500)},generateAndReturnInitialHtml=function(){var e=createDomNode("div",{class:"search__outer__wrapper search__backdrop"}),t=createDomNode("div",{class:"search__outer"}),n=createDomNode("div",{class:"search__cross",title:"Close"});n.innerHTML="<?xml version='1.0' encoding='UTF-8'?><svg class='search__cross__img' width='15px' height='15px' enable-background='new 0 0 612 612' version='1.1' viewBox='0 0 612 612' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'><polygon points='612 36.004 576.52 0.603 306 270.61 35.478 0.603 0 36.004 270.52 306.01 0 576 35.478 611.4 306 341.41 576.52 611.4 612 576 341.46 306.01'/></svg>",t.appendChild(n);var r=createDomNode("input",{class:"search__outer__input",placeholder:"Search ..."}),i=createDomNode("span",{class:"bar"});return t.appendChild(r),t.appendChild(i),e.appendChild(t),{search_outer_wrapper:e,search_outer_input:r,search_outer:t,cross_icon:n}},showSearchModal=function(){removeResults(),getInputField().blur(),document.querySelector(".search__outer__wrapper").classList.add("display-block");var e=document.querySelector(".search__outer__input");null!==e&&(e.value="",e.focus())},removeSearchModal=function(){removeResults();var e=document.querySelector(".search__outer__input");null!==e&&(e.value="",e.blur()),document.querySelector(".search__outer__wrapper").classList.remove("display-block")};window.addEventListener("DOMContentLoaded",function(e){if(void 0!==READTHEDOCS_DATA){var r=READTHEDOCS_DATA.project,i=READTHEDOCS_DATA.version,o=READTHEDOCS_DATA.language||"en",a=READTHEDOCS_DATA.api_host,t=generateAndReturnInitialHtml(),n=t.search_outer_wrapper,s=t.search_outer_input,l=t.cross_icon;document.body.appendChild(n);var c=0,u=null,d=getInputField();d.addEventListener("focus",function(e){showSearchModal()}),s.addEventListener("input",function(e){SEARCH_QUERY=e.target.value,COUNT=0;var t={q:encodeURIComponent(SEARCH_QUERY),project:r,version:i,language:o},n=a+"/api/v2/docsearch/?"+convertObjToUrlParams(t);"string"==typeof SEARCH_QUERY&&0<SEARCH_QUERY.length?(null!==u&&u.cancel(),(u=fetchAndGenerateResults(n,r))()):debounce(removeResults,600)()}),s.addEventListener("keydown",function(e){if(40===e.keyCode&&(e.preventDefault(),COUNT<(c+=1)&&(c=1),removeAllActive(),addActive(c)),38===e.keyCode&&(e.preventDefault(),(c-=1)<1&&(c=COUNT),removeAllActive(),addActive(c)),13===e.keyCode){e.preventDefault();var t=document.querySelector(".outer_div_page_results.active");if(null!==t){var n=t.parentElement.href;window.location.href=n}else{var r=getInputField().parentElement;d.value=SEARCH_QUERY||"",r.submit()}}}),n.addEventListener("click",function(e){e.target.parentNode===document.body&&removeSearchModal()}),l.addEventListener("click",function(e){removeSearchModal()}),document.addEventListener("keydown",function(e){27===e.keyCode&&removeSearchModal()})}});